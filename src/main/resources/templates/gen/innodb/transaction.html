<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <th:block th:include="include :: header('首页')"/>
    <link rel="stylesheet" th:href="@{/static/admin/css/other/console1.css}"/>
</head>

<body class="pear-container">

<div class="layui-card">
    <div class="layui-card-body">
        <table id="transaction-table" lay-filter="transaction-table"></table>
    </div>
</div>
<script type="text/html" id="transaction-toolbar">
</script>
<th:block th:include="include :: footer"/>
<script>
    layui.use(['layer', 'echarts', 'element', 'count', 'topBar', 'code', 'form', 'jquery', 'table'], function () {
        layui.code();
        let table = layui.table;
        let MODULE_PATH = rootPath + "/InnodbController";
        let $ = layui.jquery;
        let count = layui.count,
            echarts = layui.echarts;

        var form = layui.form;


        let cols = [
            [

                {title: 'trxId', field: 'trxId', align: 'center'},

                {title: 'trxState', field: 'trxState', align: 'center'},

                {title: 'trxStarted', field: 'trxStarted', align: 'center'},

                {title: 'trxRequestedLockId', field: 'trxRequestedLockId', align: 'center'},

                {title: 'trxWaitStarted', field: 'trxWaitStarted', align: 'center'},

                {title: 'trxWeight', field: 'trxWeight', align: 'center'},

                {title: 'trxMysqlThreadId', field: 'trxMysqlThreadId', align: 'center'},

                {title: 'trxQuery', field: 'trxQuery', align: 'center'},

                {title: 'trxOperationState', field: 'trxOperationState', align: 'center'},

                {title: 'trxTablesInUse', field: 'trxTablesInUse', align: 'center'},

                {title: 'trxTablesInUse', field: 'trxTablesInUse', align: 'center'},

                {title: 'trxTablesLocked', field: 'trxTablesLocked', align: 'center'},

                {title: 'trxLockStructs', field: 'trxLockStructs', align: 'center'},

                {title: 'trxLockMemoryBytes', field: 'trxLockMemoryBytes', align: 'center'},

                {title: 'trxRowsLocked', field: 'trxRowsLocked', align: 'center'},

                {title: 'trxRowsModified', field: 'trxRowsModified', align: 'center'},

                {title: 'trxConcurrencyTickets', field: 'trxConcurrencyTickets', align: 'center'},

                {title: 'trxIsolationLevel', field: 'trxIsolationLevel', align: 'center'},

                {title: 'trxUniqueChecks', field: 'trxUniqueChecks', align: 'center'},

                {title: 'trxForeignKeyChecks', field: 'trxForeignKeyChecks', align: 'center'},

                {title: 'trxLastForeignKeyError', field: 'trxLastForeignKeyError', align: 'center'},

                {title: 'trxAdaptiveHashLatched', field: 'trxAdaptiveHashLatched', align: 'center'},

                {title: 'trxAdaptiveHashTimeout', field: 'trxAdaptiveHashTimeout', align: 'center'},

                {title: 'trxIsReadOnly', field: 'trxIsReadOnly', align: 'center'},

                {title: 'trxAutocommitNonLocking', field: 'trxAutocommitNonLocking', align: 'center'},

            ]
        ]

        //table表单列表

        table.render({
            elem: '#transaction-table',
            url: MODULE_PATH + '/trx/' + window.localStorage.getItem("curServer"),
            page: true,
            method: 'get',
            cols: cols,
            skin: 'line',
            toolbar: '#transaction-toolbar',
            defaultToolbar: [{
                layEvent: 'refresh',
                icon: 'layui-icon-refresh',
            }, 'filter', 'print', 'exports']
        });

        //查询按钮绑定
        // form.on('submit(transaction-query)', function (data) {
        //     table.reload('processlist-table', {page: {curr: 1}, where: data.field})
        //     return false;
        // });

        //table工具栏绑定
        table.on('toolbar(transaction-table)', function (obj) {
            if (obj.event === 'refresh') {
                window.refresh();
            }
        });

        //刷新按钮
        window.refresh = function () {
            table.reload('transaction-table');
        }
    });
</script>
</body>

</html>